# CareNest Deployment Guide

This guide will help you deploy CareNest to free hosting platforms.

## Backend Deployment (Render.com)

### Prerequisites
- GitHub account
- Render.com account (sign up at https://render.com)

### Steps

1. **Push your code to GitHub** (if not already done)
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-github-repo-url>
   git push -u origin main
   ```

2. **Deploy to Render**
   - Go to https://render.com/dashboard
   - Click "New +" → "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect the `render.yaml` file
   - Set the environment variable `CORS_ORIGIN` to your frontend URL (you'll get this after deploying frontend)
   - Click "Apply" to deploy

3. **Note your backend URL**
   - After deployment, you'll get a URL like: `https://carenest-backend.onrender.com`
   - Save this URL for frontend configuration

### Important Notes
- Free tier spins down after 15 minutes of inactivity
- First request after spin-down may take 30-60 seconds
- SQLite database persists on the disk mount
- You get 750 hours/month free (enough for one service running 24/7)

---

## Frontend Deployment

You can choose either Vercel or Netlify. Both are excellent for React apps.

### Option 1: Vercel (Recommended)

1. **Install Vercel CLI** (optional)
   ```bash
   npm install -g vercel
   ```

2. **Deploy via Dashboard**
   - Go to https://vercel.com
   - Click "Add New" → "Project"
   - Import your GitHub repository
   - Vercel will auto-detect the configuration from `vercel.json`
   - Add environment variable:
     - `VITE_API_URL` = your Render backend URL (e.g., `https://carenest-backend.onrender.com`)
   - Click "Deploy"

3. **Or deploy via CLI**
   ```bash
   vercel
   ```

### Option 2: Netlify

1. **Deploy via Dashboard**
   - Go to https://netlify.com
   - Click "Add new site" → "Import an existing project"
   - Connect to GitHub and select your repository
   - Netlify will auto-detect settings from `netlify.toml`
   - Add environment variable:
     - `VITE_API_URL` = your Render backend URL
   - Click "Deploy"

2. **Or deploy via CLI**
   ```bash
   npm install -g netlify-cli
   netlify deploy --prod
   ```

---

## Environment Variables Setup

### Backend (.env on Render)
```
NODE_ENV=production
PORT=3000
CORS_ORIGIN=https://your-frontend-url.vercel.app
JWT_SECRET=<auto-generated-by-render>
DATABASE_PATH=/opt/render/project/src/packages/backend/data/carenest.db
```

### Frontend (.env on Vercel/Netlify)
```
VITE_API_URL=https://carenest-backend.onrender.com
```

---

## Post-Deployment Steps

1. **Update CORS_ORIGIN on Render**
   - After deploying frontend, copy your frontend URL
   - Go to Render dashboard → Your service → Environment
   - Update `CORS_ORIGIN` with your frontend URL
   - Save changes (service will redeploy)

2. **Test the deployment**
   - Visit your frontend URL
   - Try logging in or creating an account
   - Check browser console for any errors

3. **Monitor your services**
   - Render: https://render.com/dashboard
   - Vercel: https://vercel.com/dashboard
   - Netlify: https://app.netlify.com

---

## Troubleshooting

### Backend Issues
- **503 Service Unavailable**: Free tier is spinning up (wait 30-60 seconds)
- **CORS errors**: Check that `CORS_ORIGIN` matches your frontend URL exactly
- **Database errors**: Ensure disk mount is properly configured in render.yaml

### Frontend Issues
- **API calls failing**: Check that `VITE_API_URL` is set correctly
- **404 on refresh**: Ensure redirects are configured (already in vercel.json/netlify.toml)
- **Build fails**: Check that all dependencies are in package.json

### Common Fixes
```bash
# Clear build cache on Vercel
vercel --force

# Check Render logs
# Go to Dashboard → Your service → Logs

# Test API endpoint directly
curl https://your-backend-url.onrender.com/api/health
```

---

## Cost Breakdown (Free Tiers)

### Render
- ✅ 750 hours/month free
- ✅ 1GB persistent disk
- ✅ Automatic SSL
- ⚠️ Spins down after 15 min inactivity

### Vercel
- ✅ Unlimited personal projects
- ✅ 100GB bandwidth/month
- ✅ Automatic SSL & CDN
- ✅ Instant deployments

### Netlify
- ✅ 100GB bandwidth/month
- ✅ 300 build minutes/month
- ✅ Automatic SSL & CDN
- ✅ Instant rollbacks

---

## Alternative Free Hosting Options

### Backend Alternatives
- **Railway.app**: $5 free credit/month, better performance than Render
- **Fly.io**: 3 shared VMs free, better for always-on services
- **Cyclic.sh**: Free tier with MongoDB (would need to migrate from SQLite)

### Frontend Alternatives
- **Cloudflare Pages**: Unlimited bandwidth, very fast CDN
- **GitHub Pages**: Free but requires static site (no server-side routing without workarounds)

---

## Upgrading to Paid Plans (Optional)

If you need better performance:
- **Render**: $7/month for always-on service
- **Vercel Pro**: $20/month for team features
- **Netlify Pro**: $19/month for team features

---

## Quick Deploy Commands

```bash
# Deploy everything at once
git push origin main  # Triggers auto-deploy on all platforms

# Manual frontend deploy (Vercel)
cd packages/frontend && vercel --prod

# Manual frontend deploy (Netlify)
cd packages/frontend && netlify deploy --prod
```

---

## Support

- Render Docs: https://render.com/docs
- Vercel Docs: https://vercel.com/docs
- Netlify Docs: https://docs.netlify.com
